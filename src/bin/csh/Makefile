#	$ssdlinux: Makefile,v 1.2 2002/05/31 04:27:25 yamagata Exp $

.include <bsd.own.mk>

PROG=	csh
SRCS=	alloc.c char.c const.c csh.c dir.c dol.c err.c exec.o exp.c file.c \
	func.c glob.c hist.c init.c lex.c misc.c parse.c print.c printf.c \
	proc.c sem.c set.c str.c time.c _glob.c

MLINKS= csh.1 limit.1 csh.1 alias.1 csh.1 bg.1 csh.1 dirs.1 csh.1 fg.1 \
        csh.1 foreach.1 csh.1 history.1 csh.1 jobs.1 csh.1 popd.1 \
        csh.1 pushd.1 csh.1 rehash.1 csh.1 repeat.1 csh.1 suspend.1 \
        csh.1 stop.1 csh.1 source.1

err.h: 
	@rm -f $@
	@echo '/* Do not edit this file, make creates it. */' > $@
	@echo '#ifndef _h_sh_err' >> $@
	@echo '#define _h_sh_err' >> $@
	egrep 'ERR_' ./$*.c | egrep '^#define' >> $@
	@echo '#endif /* _h_sh_err */' >> $@

const.h: 
	@rm -f $@
	@echo '/* Do not edit this file, make creates it. */' > $@
	${CC} -E ${CPPFLAGS} ./$*.c | egrep 'Char STR' | \
	    sed -e 's/Char \([a-zA-Z0-9_]*\)\(.*\)/extern Char \1[];/' | \
	    sort >> $@

CPPFLAGS+=	-U_POSIX_SOURCE -DFILEC -DSHORT_STRINGS -D__USE_BSD
#LDADD+=         

NOGCCERROR=	YES

CLEANFILES+=	err.h const.h

.include <bsd.prog.mk>

${OBJS}: err.h const.h
